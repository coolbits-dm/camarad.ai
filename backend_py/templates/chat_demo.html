<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Camarad.AI Demo Chat</title>
  <link rel="icon" type="image/x-icon" href="/static/brand/favicon.ico">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      color: #dbe3f0;
      font-family: "Segoe UI", "SF Pro Text", "Helvetica Neue", sans-serif;
      background:
        radial-gradient(880px 460px at 12% -180px, rgba(31, 111, 235, 0.2), transparent 70%),
        linear-gradient(180deg, #090d14 0%, #0b111b 100%);
    }
    .shell {
      width: min(920px, calc(100% - 1.5rem));
      margin: 1rem auto;
      border: 1px solid #263349;
      border-radius: 14px;
      background: rgba(15, 22, 35, 0.95);
      overflow: hidden;
    }
    .top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.9rem 1rem;
      border-bottom: 1px solid #263349;
    }
    .badge-demo {
      background: rgba(255, 184, 0, 0.18);
      border: 1px solid rgba(255, 184, 0, 0.4);
      color: #ffd27b;
      border-radius: 999px;
      padding: 0.2rem 0.55rem;
      font-size: 0.78rem;
    }
    .chat-box {
      height: min(56vh, 520px);
      overflow-y: auto;
      padding: 1rem;
      background: #0d1117;
    }
    .msg {
      max-width: 75%;
      border-radius: 12px;
      padding: 0.65rem 0.8rem;
      margin-bottom: 0.75rem;
      border: 1px solid #30363d;
      background: #161b22;
    }
    .msg.user {
      margin-left: auto;
      border-color: #2f6feb;
      background: #12345d;
    }
    .composer {
      display: flex;
      gap: 0.6rem;
      padding: 0.85rem;
      border-top: 1px solid #263349;
      background: #111827;
    }
    .composer input {
      flex: 1;
      border: 1px solid #2a3952;
      background: #0f1827;
      color: #e0e8f5;
      border-radius: 10px;
      padding: 0.62rem 0.72rem;
    }
    .composer input:focus {
      outline: none;
      border-color: #3f82be;
      box-shadow: 0 0 0 3px rgba(57, 160, 255, 0.25);
    }
    .quick {
      display: flex;
      gap: 0.45rem;
      flex-wrap: wrap;
      padding: 0 0.85rem 0.85rem;
      background: #111827;
    }
    .quick button {
      border: 1px solid #314869;
      border-radius: 999px;
      background: #15253d;
      color: #cfe2fb;
      font-size: 0.82rem;
      padding: 0.34rem 0.66rem;
    }
  </style>
</head>
<body>
  <section class="shell">
    <div class="top">
      <div class="d-flex align-items-center gap-2">
        <img src="/static/brand/camarad-logo-64.png" alt="Camarad logo" width="28" height="28">
        <strong>Personal Assistant Demo</strong>
        <span class="badge-demo">No saving Â· Mock responses</span>
      </div>
      <div class="d-flex gap-2">
        <a class="btn btn-sm btn-outline-light" href="/landing">Back</a>
        <a class="btn btn-sm btn-outline-light" data-track="demo_open" data-track-from="chat_demo" href="/platform-demo?src=chat_demo">Open full demo</a>
        <a class="btn btn-sm btn-primary" data-track="signup" data-track-from="chat_demo" href="/signup?next=%2Fchat%2Fpersonal%2Flife-coach%3Ffrom%3Dchat_demo">Start with Google</a>
      </div>
    </div>
    <div id="chatBox" class="chat-box">
      <div class="msg">
        <strong>Personal Assistant</strong><br>
        Welcome to demo mode. I can show you how Camarad routes requests across agents, connectors, and orchestrated flows.
      </div>
    </div>
    <div class="quick">
      <button type="button" data-q="Analyze last 30 days performance and show top 3 actions.">Analyze last 30 days performance</button>
      <button type="button" data-q="Create a PPC + SEO weekly plan for this client.">Build PPC + SEO weekly plan</button>
      <button type="button" data-q="Generate an executive brief from Ads + GA4 KPIs.">Generate executive brief</button>
    </div>
    <div class="composer">
      <input id="q" type="text" placeholder="Try: What should I optimize first for growth?">
      <button id="sendBtn" class="btn btn-primary"><i class="bi bi-send me-1"></i>Send</button>
    </div>
  </section>

  <script>
    (function () {
      window.dataLayer = window.dataLayer || [];
      window.dataLayer.push({
        event: "demo_open",
        demo_type: "chat_demo",
        page_path: window.location.pathname
      });

      var seedQ = {{ (seed_q or '')|tojson }};
      var chatBox = document.getElementById("chatBox");
      var input = document.getElementById("q");
      var sendBtn = document.getElementById("sendBtn");
      var sentTracked = false;

      document.querySelectorAll('a[data-track="signup"]').forEach(function (el) {
        el.addEventListener("click", function () {
          window.dataLayer.push({
            event: "signup_click",
            source: el.getAttribute("data-track-from") || "chat_demo",
            href: el.getAttribute("href") || ""
          });
        });
      });
      document.querySelectorAll('a[data-track="demo_open"]').forEach(function (el) {
        el.addEventListener("click", function () {
          window.dataLayer.push({
            event: "demo_open",
            source: el.getAttribute("data-track-from") || "chat_demo",
            href: el.getAttribute("href") || ""
          });
        });
      });

      var canned = [
        "Great starting point. First, audit ROAS by campaign, then reallocate budget toward high-intent segments.",
        "Use GA4 funnels to identify drop-off stages, then pair that with PPC search terms to remove wasted spend.",
        "I can route this to PPC Specialist + SEO Strategist and return one unified action plan.",
      ];

      function add(role, text) {
        var div = document.createElement("div");
        div.className = "msg" + (role === "user" ? " user" : "");
        div.innerHTML = "<strong>" + (role === "user" ? "You" : "Personal Assistant") + "</strong><br>" + text;
        chatBox.appendChild(div);
        chatBox.scrollTop = chatBox.scrollHeight;
      }

      function respond(q) {
        var msg = String(q || "").trim();
        if (!msg) return;
        if (!sentTracked) {
          sentTracked = true;
          window.dataLayer.push({
            event: "first_chat_send",
            source: "chat_demo",
            query_length: msg.length
          });
        }
        add("user", msg);
        input.value = "";
        setTimeout(function () {
          var idx = Math.floor(Math.random() * canned.length);
          add("assistant", canned[idx]);
        }, 380);
      }

      sendBtn.addEventListener("click", function () { respond(input.value); });
      input.addEventListener("keydown", function (e) {
        if (e.key === "Enter") {
          e.preventDefault();
          respond(input.value);
        }
      });
      document.querySelectorAll(".quick button").forEach(function (btn) {
        btn.addEventListener("click", function () { respond(btn.getAttribute("data-q")); });
      });

      if (seedQ) {
        input.value = seedQ;
        respond(seedQ);
      }
    })();
  </script>
</body>
</html>
